<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Claim Checker</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>
  <body>
    <nav class="navbar">
      <div class="nav-logo">üß† AI Classifier</div>
      <ul class="nav-links">
        <li><a href="{{ url_for('index')}}" class="home-link">Home</a></li>
        <li>
          <a href="{{ url_for('bot_detector')}}" class="home-link"
            >Bot-Detector</a
          >
        </li>
        <li>
          <a href="{{ url_for('image_classifier') }}" class="home-link"
            >Image Classifier</a
          >
        </li>
      </ul>
    </nav>

    <div class="container">
      <h1>Check the Accuracy of a Tweet</h1>
      <p>
        Paste a Twitter/X link below and get an automated reliability score.
      </p>

      <form id="claimForm">
        <input
          type="url"
          id="tweetUrl"
          placeholder="Enter Twitter link..."
          required
        />
        <button type="submit">Analyze</button>
      </form>

      <div id="loading" class="hidden">Analyzing tweet...</div>

      <div id="result" class="hidden">
        <h2>Result</h2>
        <p id="verdict"></p>

        <div id="confidenceContainer">
          <div id="confidenceBar"></div>
        </div>
        <p id="confidenceText"></p>

        <div id="analysis"></div>
      </div>
    </div>

    <script>
      const form = document.getElementById("claimForm");
      const loading = document.getElementById("loading");
      const result = document.getElementById("result");
      const verdict = document.getElementById("verdict");
      const analysis = document.getElementById("analysis");
      const bar = document.getElementById("confidenceBar");
      const confidenceText = document.getElementById("confidenceText");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const tweetUrl = document.getElementById("tweetUrl").value;

        loading.classList.remove("hidden");
        result.classList.add("hidden");

        try {
          const response = await fetch("/claim-checker/analyse", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ url: tweetUrl }),
          });

          const data = await response.json();
          loading.classList.add("hidden");
          result.classList.remove("hidden");

          if (data.error) {
            verdict.textContent = "‚ùå Error: " + data.error;
            return;
          }

          // Update UI
          verdict.innerHTML =
            data.label === "true"
              ? "‚úÖ Likely True"
              : data.label === "mixed"
              ? "‚ö†Ô∏è Mixed or Uncertain"
              : "‚ùå Likely False";

          bar.style.width = `${data.confidence * 100}%`;
          bar.style.background =
            data.label === "true"
              ? "#2ecc71"
              : data.label === "mixed"
              ? "#f1c40f"
              : "#e74c3c";

          confidenceText.textContent = `Confidence: ${(
            data.confidence * 100
          ).toFixed(1)}%`;

          analysis.innerHTML = `<p><strong>Analysis:</strong> ${data.explanation}</p>`;
        } catch (err) {
          loading.classList.add("hidden");
          result.classList.remove("hidden");
          verdict.textContent = "‚ö†Ô∏è Server error. Please try again.";
        }
      });
    </script>
  </body>
</html>
